<Window x:Class="PhotoSorter.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="相册整理助手"
        Icon="pack://application:,,,/app.ico"
        Height="800" Width="1100" MinHeight="640" MinWidth="960" WindowStartupLocation="CenterScreen"
        UseLayoutRounding="True">
    <DockPanel LastChildFill="True">
        <!-- Header docked to top with purple accent -->
        <Border Background="{StaticResource AccentBrush}" Padding="16,12" DockPanel.Dock="Top">
            <StackPanel>
                <TextBlock Text="相册整理助手" FontSize="20" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="点击上方方框打开资源管理器，或将文件夹拖进去；推荐排序：横/竖 → 颜色 → 亮度。"
                           TextWrapping="Wrap" FontSize="12" Foreground="#CCFFFFFF"/>
            </StackPanel>
        </Border>

        <!-- Footer tips -->
        <DockPanel Margin="16" DockPanel.Dock="Bottom">
            <TextBlock Text="拖拽文件夹到页面任意位置可快速选择" Foreground="Gray"/>
        </DockPanel>

        <!-- Main content -->
        <Grid Margin="16" AllowDrop="True" Drop="OnDrop" DragOver="OnDragOver">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <!-- Left side scrollable content -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Big dashed drop zone on top: click = choose folder; also supports drag&drop -->
                <Grid Height="180" Margin="0,0,0,12" AllowDrop="True" Drop="OnDrop" DragOver="OnDragOver" MouseLeftButtonUp="OnOpenFolder" Cursor="Hand">
                    <Rectangle RadiusX="10" RadiusY="10" Stroke="#884B5563" StrokeThickness="2" StrokeDashArray="6 6" Fill="#08A78BFA"/>
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock Text="点击打开资源管理器，或将文件夹拖到此处" Foreground="#7C3AED" FontWeight="SemiBold"/>
                        <TextBlock Text="支持拖拽整个文件夹" Foreground="#7C3AED" Opacity="0.8" FontSize="12" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>

                <!-- Quick help card -->
                <Border Background="#0F000000" BorderBrush="#22000000" BorderThickness="1" CornerRadius="8" Padding="8" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock Text="快速说明" FontWeight="SemiBold"/>
                        <TextBlock Text="• 横/竖：按照片长宽比分组（横向/纵向）。" TextWrapping="Wrap" Margin="0,4,0,0"/>
                        <TextBlock Text="• 颜色：在同一组内按主色调排序。" TextWrapping="Wrap"/>
                        <TextBlock Text="• 亮度：再按明暗程度排序。" TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <!-- Path input on its own line -->
                <TextBlock Text="目标文件夹路径" FontWeight="SemiBold"/>
                <TextBox x:Name="TxtPath" Margin="0,4,0,12" AllowDrop="False"/>

                <GroupBox Header="排序策略" Padding="8">
                    <StackPanel>
                        <RadioButton x:Name="RbColorFirst" Content="横/竖 → 颜色 → 亮度（推荐）" IsChecked="True"/>
                        <RadioButton x:Name="RbBrightnessFirst" Content="亮度 → 颜色（原版）"/>
                        <CheckBox x:Name="ChkIncludeSub" Content="包含子文件夹"/>
                        <CheckBox x:Name="ChkNormalize" Content="规范化子文件夹（01、02、...）"/>
                        <CheckBox x:Name="ChkDryRun" Content="仅预览（不改名/不复制）"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="输出模式" Padding="8" Margin="0,8,0,0">
                    <StackPanel>
                        <RadioButton x:Name="RbInPlace" Content="就地重命名" IsChecked="True"/>
                        <DockPanel>
                            <RadioButton x:Name="RbCopy" Content="复制到输出文件夹" Checked="OnCopyChecked" Unchecked="OnCopyChecked"/>
                            <TextBox x:Name="TxtOut" Margin="12,0,0,0" Width="220" IsEnabled="False"/>
                            <Button Content="选择..." Click="OnChooseOut" Margin="8,0,0,0" IsEnabled="False" x:Name="BtnOut"/>
                        </DockPanel>
                    </StackPanel>
                </GroupBox>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                    <Button Content="开始运行" Click="OnRun"/>
                </StackPanel>
            </StackPanel>
            </ScrollViewer>

            <GroupBox Grid.Column="1" Header="日志" Padding="8" Margin="12,0,0,0"
                      VerticalAlignment="Stretch" VerticalContentAlignment="Stretch">
                <TextBox x:Name="TxtLog" Height="Auto" MinHeight="260" VerticalAlignment="Stretch"
                         TextWrapping="Wrap"
                         VerticalScrollBarVisibility="Auto"
                         HorizontalScrollBarVisibility="Disabled"
                         IsReadOnly="True" AcceptsReturn="True"/>
            </GroupBox>
        </Grid>
    </DockPanel>
</Window>
